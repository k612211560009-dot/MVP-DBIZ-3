import React, { useState, useEffect } from "react";
import { useNavigate, useSearchParams, Link } from "react-router-dom";
import { useAuth } from "../context/AuthContext";
import { Header } from "../components/Header";
import { Stepper } from "../components/Stepper";
import { Button } from "../components/ui/button";
import {
  Card,
  CardContent,
  CardHeader,
  CardTitle,
  CardDescription,
} from "../components/ui/card";
import { Input } from "../components/ui/input";
import { Label } from "../components/ui/label";
import { Textarea } from "../components/ui/textarea";
import { PhoneInput } from "../components/PhoneInput";
import { RadioGroup, RadioGroupItem } from "../components/ui/radio-group";
import { Checkbox } from "../components/ui/checkbox";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "../components/ui/select";
import { Alert, AlertDescription } from "../components/ui/alert";
import { toast } from "sonner";
import { Toaster } from "../components/ui/sonner";
import {
  Heart,
  Shield,
  FileCheck,
  CheckCircle,
  Info,
  ChevronLeft,
  Calendar as CalendarIcon,
  ArrowLeft,
  Home,
  X,
} from "lucide-react";

const STEPS = [
  { id: 1, label: "Personal Info" },
  { id: 2, label: "Health Screening" },
  { id: 3, label: "Review & Submit" },
  { id: 4, label: "Schedule Interview" },
  { id: 5, label: "EHR & Medical Tests" },
];

const PROVINCES = [
  "An Giang",
  "B√† R·ªãa - V≈©ng T√†u",
  "B·∫°c Li√™u",
  "B·∫Øc Giang",
  "B·∫Øc K·∫°n",
  "B·∫Øc Ninh",
  "B·∫øn Tre",
  "B√¨nh ƒê·ªãnh",
  "B√¨nh D∆∞∆°ng",
  "B√¨nh Ph∆∞·ªõc",
  "B√¨nh Thu·∫≠n",
  "C√† Mau",
  "C·∫ßn Th∆°",
  "Cao B·∫±ng",
  "ƒê√† N·∫µng",
  "ƒê·∫Øk L·∫Øk",
  "ƒê·∫Øk N√¥ng",
  "ƒêi·ªán Bi√™n",
  "ƒê·ªìng Nai",
  "ƒê·ªìng Th√°p",
  "Gia Lai",
  "H√† Giang",
  "H√† Nam",
  "H√† N·ªôi",
  "H√† Tƒ©nh",
  "H·∫£i D∆∞∆°ng",
  "H·∫£i Ph√≤ng",
  "H·∫≠u Giang",
  "H√≤a B√¨nh",
  "H∆∞ng Y√™n",
  "Kh√°nh H√≤a",
  "Ki√™n Giang",
  "Kon Tum",
  "Lai Ch√¢u",
  "L√¢m ƒê·ªìng",
  "L·∫°ng S∆°n",
  "L√†o Cai",
  "Long An",
  "Nam ƒê·ªãnh",
  "Ngh·ªá An",
  "Ninh B√¨nh",
  "Ninh Thu·∫≠n",
  "Ph√∫ Th·ªç",
  "Ph√∫ Y√™n",
  "Qu·∫£ng B√¨nh",
  "Qu·∫£ng Nam",
  "Qu·∫£ng Ng√£i",
  "Qu·∫£ng Ninh",
  "Qu·∫£ng Tr·ªã",
  "S√≥c TrƒÉng",
  "S∆°n La",
  "T√¢y Ninh",
  "Th√°i B√¨nh",
  "Th√°i Nguy√™n",
  "Thanh H√≥a",
  "Th·ª´a Thi√™n Hu·∫ø",
  "Ti·ªÅn Giang",
  "TP H·ªì Ch√≠ Minh",
  "Tr√† Vinh",
  "Tuy√™n Quang",
  "Vƒ©nh Long",
  "Vƒ©nh Ph√∫c",
  "Y√™n B√°i",
];

// 10 screening questions for donor
const SCREENING_QUESTIONS = [
  { id: "q1", text: "B·∫°n c√≥ ƒëang cho con b√∫ kh√¥ng?", required: true },
  { id: "q2", text: "B·∫°n c√≥ b·ªã b·ªánh truy·ªÅn nhi·ªÖm kh√¥ng?", required: true },
  {
    id: "q3",
    text: "B·∫°n c√≥ ƒëang d√πng thu·ªëc kh√°ng sinh kh√¥ng?",
    required: true,
  },
  { id: "q4", text: "B·∫°n c√≥ h√∫t thu·ªëc ho·∫∑c u·ªëng r∆∞·ª£u kh√¥ng?", required: true },
  { id: "q5", text: "B·∫°n c√≥ ti·ªÅn s·ª≠ b·ªánh tim m·∫°ch kh√¥ng?", required: true },
  {
    id: "q6",
    text: "B·∫°n c√≥ ƒëang ƒëi·ªÅu tr·ªã b·ªánh m√£n t√≠nh kh√¥ng?",
    required: true,
  },
  {
    id: "q7",
    text: "B·∫°n c√≥ xƒÉm m√¨nh trong 12 th√°ng qua kh√¥ng?",
    required: true,
  },
  {
    id: "q8",
    text: "B·∫°n c√≥ truy·ªÅn m√°u trong 12 th√°ng qua kh√¥ng?",
    required: true,
  },
  {
    id: "q9",
    text: "B·∫°n c√≥ s·∫µn s√†ng cam k·∫øt hi·∫øn s·ªØa ƒë·ªãnh k·ª≥ kh√¥ng?",
    required: true,
  },
  {
    id: "q10",
    text: "B·∫°n c√≥ ƒë·ªìng √Ω cho ph√©p l∆∞u tr·ªØ th√¥ng tin y t·∫ø kh√¥ng?",
    required: true,
  },
];

export default function RegistrationFlow() {
  const [currentStep, setCurrentStep] = useState(1);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [searchParams] = useSearchParams();
  const navigate = useNavigate();
  const { register, user } = useAuth();
  const [showEHROption, setShowEHROption] = useState(false); // EHR only shows at step 4
  const [usingEHR, setUsingEHR] = useState(false);
  const [donorId, setDonorId] = useState("");
  const [selectedSlot, setSelectedSlot] = useState(null);
  const [confirmedAppointment, setConfirmedAppointment] = useState(false);
  const [interviewScheduled, setInterviewScheduled] = useState(false);
  const [screeningApproved, setScreeningApproved] = useState(false);
  const [ehrTestsExtracted, setEhrTestsExtracted] = useState(false);

  // Get role from URL params - default to donor
  const userRole = searchParams.get("role") || "donor";

  const [personalInfo, setPersonalInfo] = useState({
    fullName: "",
    dob: "",
    idPassport: "",
    phone: "",
    email: "",
    province: "",
    district: "",
    ward: "",
    address: "",
    contactMethod: "phone",
  });

  const [healthInfo, setHealthInfo] = useState({
    hasChronicDisease: false,
    chronicDiseases: [],
    medications: "",
    allergies: "",
    pregnancyHistory: "",
    breastfeedingStatus: "",
  });

  const [screeningAnswers, setScreeningAnswers] = useState({});
  const [confirmCorrect, setConfirmCorrect] = useState(false);
  const [ehrTestResults, setEhrTestResults] = useState(null);
  const [hasPositiveTest, setHasPositiveTest] = useState(false);
  const [showVideoTutorial, setShowVideoTutorial] = useState(false);
  const [registrationComplete, setRegistrationComplete] = useState(false);

  const handlePersonalInfoChange = (field, value) => {
    setPersonalInfo((prev) => ({
      ...prev,
      [field]: value,
    }));
  };

  const handleUseEHR = async () => {
    // Simulate EHR extraction with random results
    // In production, this would call backend API
    const mockResults = {
      hiv: { status: "negative", date: "2025-10-15" },
      hepatitisB: { status: "negative", date: "2025-10-15" },
      hepatitisC: { status: "negative", date: "2025-10-15" },
      syphilis: { status: "negative", date: "2025-10-15" },
      tuberculosis: { status: "negative", date: "2025-10-15" },
    };

    // Randomly simulate a positive result for testing (10% chance)
    const hasPositive = Math.random() < 0.1;
    
    if (hasPositive) {
      // Pick random test to be positive
      const tests = Object.keys(mockResults);
      const positiveTest = tests[Math.floor(Math.random() * tests.length)];
      mockResults[positiveTest].status = "positive";
      setHasPositiveTest(true);
    }

    setEhrTestResults(mockResults);
    setEhrTestsExtracted(true);
    setUsingEHR(true);

    // Show appropriate toast
    if (hasPositive) {
      toast.error("Ph√°t hi·ªán k·∫øt qu·∫£ d∆∞∆°ng t√≠nh!", {
        description: "R·∫•t ti·∫øc, c√≥ √≠t nh·∫•t m·ªôt x√©t nghi·ªám d∆∞∆°ng t√≠nh. H·ªì s∆° kh√¥ng th·ªÉ ti·∫øp t·ª•c.",
        duration: 5000,
      });
    } else {
      toast.success("ƒê√£ tr√≠ch xu·∫•t k·∫øt qu·∫£ x√©t nghi·ªám t·ª´ EHR!", {
        description: "T·∫•t c·∫£ x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm ƒë·ªÅu √¢m t√≠nh",
      });
    }
  };

  const handleScreeningAnswer = (questionId, answer, comment = "") => {
    setScreeningAnswers((prev) => ({
      ...prev,
      [questionId]: { answer, comment },
    }));
  };

  const isScreeningComplete = () => {
    return SCREENING_QUESTIONS.every((q) => screeningAnswers[q.id]?.answer);
  };

  const handleNext = () => {
    if (currentStep < STEPS.length) {
      // Validation for each step
      if (currentStep === 1 && !personalInfo.fullName) {
        toast.error("Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin c√° nh√¢n");
        return;
      }
      if (currentStep === 2 && !isScreeningComplete()) {
        toast.error("Vui l√≤ng tr·∫£ l·ªùi ƒë·∫ßy ƒë·ªß 10 c√¢u h·ªèi s√†ng l·ªçc");
        return;
      }
      if (currentStep === 3 && !confirmCorrect) {
        toast.error("Vui l√≤ng x√°c nh·∫≠n th√¥ng tin l√† ch√≠nh x√°c");
        return;
      }
      if (currentStep === 4 && !selectedSlot) {
        toast.error("Vui l√≤ng ch·ªçn l·ªãch h·∫πn ph·ªèng v·∫•n");
        return;
      }
      if (currentStep === 5) {
        if (!ehrTestsExtracted) {
          toast.error("Vui l√≤ng tr√≠ch xu·∫•t k·∫øt qu·∫£ x√©t nghi·ªám t·ª´ EHR");
          return;
        }
        if (hasPositiveTest) {
          toast.error("Kh√¥ng th·ªÉ ti·∫øp t·ª•c do c√≥ k·∫øt qu·∫£ x√©t nghi·ªám d∆∞∆°ng t√≠nh");
          return;
        }
      }
      
      // Submit form when moving from step 3 to 4
      if (currentStep === 3) {
        handleSubmitRegistration();
      }
      
      // Auto-schedule interview when moving from step 4 to 5
      if (currentStep === 4) {
        setInterviewScheduled(true);
        setScreeningApproved(true);
        setShowEHROption(true);
        toast.success("L·ªãch ph·ªèng v·∫•n ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n! Ti·∫øn h√†nh tr√≠ch xu·∫•t EHR...");
      }
      
      setCurrentStep(currentStep + 1);
    }
  };

  const handlePrevious = () => {
    if (currentStep > 1) {
      setCurrentStep(currentStep - 1);
    }
  };

  const handleSubmitRegistration = async () => {
    // This is called when moving from step 3 to step 4
    // Just validate and create temporary registration
    setDonorId(`DN-${Date.now().toString().slice(-6)}`);
    toast.success("ƒêƒÉng k√Ω ƒë∆∞·ª£c x√°c nh·∫≠n! Vui l√≤ng ch·ªçn l·ªãch ph·ªèng v·∫•n.");
  };

  const handleFinalSubmit = async () => {
    // This is the final submit after all steps including EHR
    setIsSubmitting(true);
    try {
      const registrationData = {
        userId: user?.user_id,
        donorId,
        personalInfo,
        screeningAnswers,
        interviewSlot: selectedSlot,
        ehrTestResults,
        donorStatus: "active", // Since all tests passed
        screeningStatus: "approved",
        directorStatus: "pending", // Waiting for director approval
        createdAt: new Date().toISOString(),
      };

      // TODO: Submit to backend API
      // POST /api/donors/register
      // This will create entries in:
      // 1. DONOR table (donor_id, home_bank_id, donor_status, screening_status, director_status)
      // 2. EHR_DONOR table (donor_id, national_id, test results, is_clear=true)
      // await api.post('/donors/register', registrationData);

      setRegistrationComplete(true);
      
      toast.success("H·ªì s∆° donor ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng!", {
        description: "Ch·ªù Gi√°m ƒë·ªëc ph√™ duy·ªát h·ªì s∆° ƒë·ªÉ b·∫Øt ƒë·∫ßu hi·∫øn s·ªØa",
      });

      // Show video tutorial after 1 second
      setTimeout(() => {
        setShowVideoTutorial(true);
      }, 1000);
    } catch (error) {
      toast.error("ƒêƒÉng k√Ω th·∫•t b·∫°i. Vui l√≤ng th·ª≠ l·∫°i.");
      console.error("Registration error:", error);
    } finally {
      setIsSubmitting(false);
    }
  };

  const handleSlotSelect = (date, time) => {
    setSelectedSlot({ date, time });
  };

  const handleConfirmAppointment = async () => {
    // TODO: Save appointment to backend
    setConfirmedAppointment(true);
    toast.success("ƒê√£ ƒë·∫∑t l·ªãch ph·ªèng v·∫•n th√†nh c√¥ng!");
  };

  const renderPersonalInfoForm = () => (
    <div className="space-y-6">
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <Heart className="h-5 w-5 text-pink-500" />
            Personal Information
          </CardTitle>
          <CardDescription>
            Please provide your personal details for registration
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div>
            <Label htmlFor="fullName">Full Name *</Label>
            <Input
              id="fullName"
              value={personalInfo.fullName}
              onChange={(e) =>
                handlePersonalInfoChange("fullName", e.target.value)
              }
              placeholder="Enter your full name"
              required
            />
          </div>

          <div>
            <Label htmlFor="dob">Date of Birth *</Label>
            <Input
              id="dob"
              type="date"
              value={personalInfo.dob}
              onChange={(e) => handlePersonalInfoChange("dob", e.target.value)}
              required
            />
          </div>

          <div>
            <Label htmlFor="idPassport">ID/Passport Number *</Label>
            <Input
              id="idPassport"
              value={personalInfo.idPassport}
              onChange={(e) =>
                handlePersonalInfoChange("idPassport", e.target.value)
              }
              placeholder="Enter your ID or passport number"
              required
            />
          </div>

          <div>
            <Label htmlFor="phone">Phone Number *</Label>
            <PhoneInput
              value={personalInfo.phone}
              onChange={(value) => handlePersonalInfoChange("phone", value)}
              placeholder="Enter your phone number"
            />
          </div>

          <div>
            <Label htmlFor="email">Email Address *</Label>
            <Input
              id="email"
              type="email"
              value={personalInfo.email}
              onChange={(e) =>
                handlePersonalInfoChange("email", e.target.value)
              }
              placeholder="Enter your email address"
              required
            />
          </div>

          <div>
            <Label htmlFor="province">Province/City *</Label>
            <Select
              onValueChange={(value) =>
                handlePersonalInfoChange("province", value)
              }
            >
              <SelectTrigger>
                <SelectValue placeholder="Select your province/city" />
              </SelectTrigger>
              <SelectContent>
                {PROVINCES.map((province) => (
                  <SelectItem key={province} value={province}>
                    {province}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label htmlFor="address">Full Address *</Label>
            <Input
              id="address"
              value={personalInfo.address}
              onChange={(e) =>
                handlePersonalInfoChange("address", e.target.value)
              }
              placeholder="Enter your full address"
              required
            />
          </div>

          <div>
            <Label>Preferred Contact Method</Label>
            <RadioGroup
              value={personalInfo.contactMethod}
              onValueChange={(value) =>
                handlePersonalInfoChange("contactMethod", value)
              }
              className="mt-2"
            >
              <div className="flex items-center space-x-2">
                <RadioGroupItem value="phone" id="phone-contact" />
                <Label htmlFor="phone-contact">Phone</Label>
              </div>
              <div className="flex items-center space-x-2">
                <RadioGroupItem value="email" id="email-contact" />
                <Label htmlFor="email-contact">Email</Label>
              </div>
              <div className="flex items-center space-x-2">
                <RadioGroupItem value="both" id="both-contact" />
                <Label htmlFor="both-contact">Both</Label>
              </div>
            </RadioGroup>
          </div>
        </CardContent>
      </Card>
    </div>
  );

  const renderScreeningForm = () => {
    const answeredCount = Object.keys(screeningAnswers).filter(
      (key) => screeningAnswers[key]?.answer
    ).length;
    const progress = (answeredCount / SCREENING_QUESTIONS.length) * 100;

    return (
      <div className="space-y-6">
        {/* Progress indicator */}
        <Card>
          <CardContent className="pt-6">
            <div className="space-y-2">
              <div className="flex justify-between text-sm">
                <span className="font-medium">Ti·∫øn ƒë·ªô</span>
                <span className="text-gray-500">
                  {answeredCount}/{SCREENING_QUESTIONS.length} c√¢u h·ªèi
                </span>
              </div>
              <div className="w-full bg-gray-200 rounded-full h-2">
                <div
                  className="bg-pink-600 h-2 rounded-full transition-all duration-300"
                  style={{ width: `${progress}%` }}
                />
              </div>
            </div>
          </CardContent>
        </Card>

        {/* Screening Questions */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <FileCheck className="h-5 w-5 text-pink-500" />
              C√¢u h·ªèi s√†ng l·ªçc s·ª©c kh·ªèe
            </CardTitle>
            <CardDescription>
              Vui l√≤ng tr·∫£ l·ªùi ƒë·∫ßy ƒë·ªß 10 c√¢u h·ªèi sau ƒë·ªÉ ƒë√°nh gi√° t√¨nh tr·∫°ng s·ª©c
              kh·ªèe c·ªßa b·∫°n
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            {SCREENING_QUESTIONS.map((question, index) => (
              <div
                key={question.id}
                className="p-4 border border-gray-200 rounded-lg space-y-3"
              >
                <div className="flex items-start gap-3">
                  <div className="flex-shrink-0 w-8 h-8 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center font-semibold text-sm">
                    {index + 1}
                  </div>
                  <div className="flex-1 space-y-3">
                    <p className="font-medium">{question.text}</p>
                    <RadioGroup
                      value={screeningAnswers[question.id]?.answer || ""}
                      onValueChange={(value) =>
                        handleScreeningAnswer(
                          question.id,
                          value,
                          screeningAnswers[question.id]?.comment
                        )
                      }
                      className="flex gap-4"
                    >
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="yes" id={`${question.id}-yes`} />
                        <Label htmlFor={`${question.id}-yes`}>C√≥</Label>
                      </div>
                      <div className="flex items-center space-x-2">
                        <RadioGroupItem value="no" id={`${question.id}-no`} />
                        <Label htmlFor={`${question.id}-no`}>Kh√¥ng</Label>
                      </div>
                    </RadioGroup>
                    {screeningAnswers[question.id]?.answer === "yes" && (
                      <div className="pt-2">
                        <Label
                          htmlFor={`${question.id}-comment`}
                          className="text-sm text-gray-600"
                        >
                          Ghi ch√∫ (n·∫øu c√≥)
                        </Label>
                        <Textarea
                          id={`${question.id}-comment`}
                          value={screeningAnswers[question.id]?.comment || ""}
                          onChange={(e) =>
                            handleScreeningAnswer(
                              question.id,
                              "yes",
                              e.target.value
                            )
                          }
                          placeholder="Vui l√≤ng cung c·∫•p th√™m th√¥ng tin..."
                          className="mt-1"
                          rows={2}
                        />
                      </div>
                    )}
                  </div>
                </div>
              </div>
            ))}
          </CardContent>
        </Card>
      </div>
    );
  };

  const renderReviewForm = () => (
    <div className="space-y-6">
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <FileCheck className="h-5 w-5 text-blue-500" />
            Xem l·∫°i th√¥ng tin
          </CardTitle>
          <CardDescription>
            Vui l√≤ng ki·ªÉm tra k·ªπ th√¥ng tin tr∆∞·ªõc khi x√°c nh·∫≠n ƒëƒÉng k√Ω
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-6">
          {/* Personal Info Summary */}
          <div>
            <h3 className="font-semibold text-lg mb-3">Th√¥ng tin c√° nh√¢n</h3>
            <div className="grid grid-cols-2 gap-4">
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  H·ªç v√† t√™n
                </Label>
                <p className="mt-1">{personalInfo.fullName}</p>
              </div>
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  Ng√†y sinh
                </Label>
                <p className="mt-1">
                  {personalInfo.dob
                    ? new Date(personalInfo.dob).toLocaleDateString("vi-VN")
                    : ""}
                </p>
              </div>
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  S·ªë CMND/Passport
                </Label>
                <p className="mt-1">{personalInfo.idPassport}</p>
              </div>
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  S·ªë ƒëi·ªán tho·∫°i
                </Label>
                <p className="mt-1">{personalInfo.phone}</p>
              </div>
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  Email
                </Label>
                <p className="mt-1">{personalInfo.email}</p>
              </div>
              <div>
                <Label className="text-sm font-medium text-gray-500">
                  T·ªânh/Th√†nh ph·ªë
                </Label>
                <p className="mt-1">{personalInfo.province}</p>
              </div>
              <div className="col-span-2">
                <Label className="text-sm font-medium text-gray-500">
                  ƒê·ªãa ch·ªâ
                </Label>
                <p className="mt-1">{personalInfo.address}</p>
              </div>
            </div>
          </div>

          {/* Screening Summary */}
          <div className="pt-4 border-t">
            <h3 className="font-semibold text-lg mb-3">
              K·∫øt qu·∫£ s√†ng l·ªçc s·ª©c kh·ªèe
            </h3>
            <div className="space-y-2">
              {SCREENING_QUESTIONS.map((question, index) => {
                const answer = screeningAnswers[question.id];
                return (
                  <div
                    key={question.id}
                    className="flex items-start gap-3 py-2"
                  >
                    <span className="text-sm text-gray-500 w-6">
                      {index + 1}.
                    </span>
                    <div className="flex-1">
                      <p className="text-sm">{question.text}</p>
                      <p className="text-sm font-semibold mt-1">
                        {answer?.answer === "yes" ? (
                          <span className="text-orange-600">C√≥</span>
                        ) : answer?.answer === "no" ? (
                          <span className="text-green-600">Kh√¥ng</span>
                        ) : (
                          <span className="text-gray-400">Ch∆∞a tr·∫£ l·ªùi</span>
                        )}
                      </p>
                      {answer?.comment && (
                        <p className="text-sm text-gray-600 mt-1 italic">
                          Ghi ch√∫: {answer.comment}
                        </p>
                      )}
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        </CardContent>
      </Card>

      {/* Confirmation Checkbox */}
      <Card>
        <CardContent className="pt-6">
          <div className="flex items-start space-x-3">
            <Checkbox
              id="confirm-correct"
              checked={confirmCorrect}
              onCheckedChange={(checked) => setConfirmCorrect(checked)}
            />
            <Label
              htmlFor="confirm-correct"
              className="font-normal cursor-pointer leading-relaxed"
            >
              T√¥i x√°c nh·∫≠n r·∫±ng t·∫•t c·∫£ th√¥ng tin ƒë∆∞·ª£c cung c·∫•p l√† ch√≠nh x√°c v√†
              trung th·ª±c. T√¥i hi·ªÉu r·∫±ng vi·ªác cung c·∫•p th√¥ng tin sai l·ªách c√≥ th·ªÉ
              d·∫´n ƒë·∫øn t·ª´ ch·ªëi ƒëƒÉng k√Ω.
            </Label>
          </div>
        </CardContent>
      </Card>

      <Alert>
        <Info className="h-4 w-4" />
        <AlertDescription>
          Sau khi x√°c nh·∫≠n, b·∫°n s·∫Ω ƒë∆∞·ª£c y√™u c·∫ßu ƒë·∫∑t l·ªãch ph·ªèng v·∫•n s√†ng l·ªçc v·ªõi nh√¢n vi√™n y t·∫ø.
        </AlertDescription>
      </Alert>
    </div>
  );

  // Step 4: Schedule Interview Form
  const renderScheduleInterviewForm = () => {
    return (
      <div className="space-y-6">
        <Alert className="border-green-200 bg-green-50">
          <CheckCircle className="h-4 w-4 text-green-600" />
          <AlertDescription className="text-green-800">
            <strong>‚úì ƒêƒÉng k√Ω ƒë√£ ƒë∆∞·ª£c x√°c nh·∫≠n!</strong> M√£ s·ªë donor: <strong className="text-pink-600">{donorId}</strong>
          </AlertDescription>
        </Alert>

        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <CalendarIcon className="h-5 w-5 text-pink-500" />
              ƒê·∫∑t l·ªãch ph·ªèng v·∫•n s√†ng l·ªçc
            </CardTitle>
            <CardDescription>
              Ch·ªçn ng√†y v√† gi·ªù ph√π h·ª£p ƒë·ªÉ tham gia ph·ªèng v·∫•n s√†ng l·ªçc s·ª©c kh·ªèe v·ªõi nh√¢n vi√™n y t·∫ø. 
              Sau khi ph·ªèng v·∫•n, nh√¢n vi√™n y t·∫ø s·∫Ω ph√™ duy·ªát th√¥ng tin v√† h·ªá th·ªëng s·∫Ω tr√≠ch xu·∫•t k·∫øt qu·∫£ x√©t nghi·ªám t·ª´ EHR.
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-4">
            <Alert className="border-blue-200 bg-blue-50">
              <Info className="h-4 w-4 text-blue-600" />
              <AlertDescription className="text-blue-800">
                Sau khi ƒëƒÉng k√Ω xong, h·ªá th·ªëng s·∫Ω x√°c th·ª±c th√¥ng tin v√† nh√¢n vi√™n y t·∫ø s·∫Ω ƒë∆∞·ª£c ph√¢n c√¥ng ph·ªèng v·∫•n qua cu·ªôc g·ªçi video.
              </AlertDescription>
            </Alert>

            {/* Time zone info */}
            <div className="flex justify-between items-center text-sm text-gray-500 flex-wrap gap-2">
              <div className="flex gap-2">
                <Button variant="outline" size="sm">
                  Bu·ªïi s√°ng (8AM - 12PM)
                </Button>
                <Button variant="outline" size="sm">
                  Bu·ªïi chi·ªÅu (1PM - 5PM)
                </Button>
              </div>
              <span>M√∫i gi·ªù: GMT+7 (TP.HCM)</span>
            </div>

            {/* Calendar Grid */}
            <div className="grid grid-cols-7 gap-3">
              {Array.from({ length: 7 }).map((_, dayIndex) => {
                const date = new Date();
                date.setDate(date.getDate() + dayIndex + 1);
                const times = ["9:00 AM", "10:30 AM", "2:00 PM", "3:30 PM"];

                return (
                  <div key={dayIndex} className="space-y-2">
                    <div className="text-center py-2 bg-gray-100 rounded-t-lg">
                      <p className="text-xs text-gray-600">
                        {date.toLocaleDateString("vi-VN", {
                          weekday: "short",
                        })}
                      </p>
                      <p className="text-sm font-medium">
                        {date.toLocaleDateString("vi-VN", {
                          day: "numeric",
                          month: "short",
                        })}
                      </p>
                    </div>
                    <div className="space-y-2">
                      {times.map((time, timeIndex) => {
                        const isSelected =
                          selectedSlot?.date?.getDate() === date.getDate() &&
                          selectedSlot?.time === time;
                        return (
                          <button
                            key={timeIndex}
                            onClick={() => handleSlotSelect(date, time)}
                            className={`w-full p-2 text-xs border rounded transition-colors ${
                              isSelected
                                ? "bg-pink-600 text-white border-pink-600"
                                : "border-gray-300 hover:bg-pink-50 hover:border-pink-600"
                            }`}
                          >
                            {time}
                          </button>
                        );
                      })}
                    </div>
                  </div>
                );
              })}
            </div>

            {selectedSlot && (
              <Alert className="border-green-200 bg-green-50">
                <CheckCircle className="h-4 w-4 text-green-600" />
                <AlertDescription className="text-green-800">
                  <strong>ƒê√£ ch·ªçn:</strong>{" "}
                  {selectedSlot.date.toLocaleDateString("vi-VN", {
                    weekday: "long",
                    day: "numeric",
                    month: "long",
                    year: "numeric",
                  })}{" "}
                  l√∫c {selectedSlot.time}
                </AlertDescription>
              </Alert>
            )}
          </CardContent>
        </Card>
      </div>
    );
  };

  // Step 4: EHR Tests Form
  const renderEHRTestsForm = () => {
    const testMapping = {
      hiv: "HIV",
      hepatitisB: "Vi√™m gan B (HBV)",
      hepatitisC: "Vi√™m gan C (HCV)",
      syphilis: "Giang mai (Syphilis)",
      tuberculosis: "Lao (TB)",
    };

    return (
      <div className="space-y-6">
        <Alert className="border-blue-200 bg-blue-50">
          <Info className="h-4 w-4 text-blue-600" />
          <AlertDescription className="text-blue-800">
            <strong>Th√¥ng tin screening ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát!</strong> B√¢y gi·ªù h·ªá th·ªëng s·∫Ω tr√≠ch xu·∫•t k·∫øt qu·∫£ x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm t·ª´ H·ªì s∆° S·ª©c kh·ªèe ƒêi·ªán t·ª≠ (EHR).
          </AlertDescription>
        </Alert>

        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Shield className="h-5 w-5 text-blue-500" />
              Tr√≠ch xu·∫•t x√©t nghi·ªám t·ª´ EHR
            </CardTitle>
            <CardDescription>
              H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông l·∫•y k·∫øt qu·∫£ x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm t·ª´ h·ªì s∆° s·ª©c kh·ªèe ƒëi·ªán t·ª≠ c·ªßa b·∫°n
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            {!ehrTestsExtracted ? (
              <div className="text-center py-8">
                <div className="bg-gradient-to-br from-blue-50 to-purple-50 p-8 rounded-lg border-2 border-dashed border-blue-300">
                  <Shield className="h-16 w-16 text-blue-600 mx-auto mb-4" />
                  <h3 className="text-lg font-semibold mb-2">
                    S·∫µn s√†ng tr√≠ch xu·∫•t k·∫øt qu·∫£ x√©t nghi·ªám
                  </h3>
                  <p className="text-gray-600 mb-6">
                    Nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ h·ªá th·ªëng t·ª± ƒë·ªông l·∫•y k·∫øt qu·∫£ x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm t·ª´ EHR
                  </p>
                  <Button
                    onClick={handleUseEHR}
                    size="lg"
                    className="bg-blue-600 hover:bg-blue-700"
                  >
                    <Shield className="h-5 w-5 mr-2" />
                    Tr√≠ch xu·∫•t t·ª´ EHR
                  </Button>
                </div>
              </div>
            ) : (
              <div className="space-y-4">
                {hasPositiveTest ? (
                  <>
                    <Alert className="border-red-200 bg-red-50">
                      <AlertDescription className="text-red-800">
                        <strong>‚ö†Ô∏è Ph√°t hi·ªán k·∫øt qu·∫£ d∆∞∆°ng t√≠nh!</strong>
                        <p className="mt-2">
                          R·∫•t ti·∫øc, c√≥ √≠t nh·∫•t m·ªôt x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm c√≥ k·∫øt qu·∫£ d∆∞∆°ng t√≠nh. 
                          Theo quy ƒë·ªãnh, h·ªì s∆° ƒëƒÉng k√Ω hi·∫øn s·ªØa m·∫π s·∫Ω <strong>KH√îNG ƒê∆Ø·ª¢C PH√ä DUY·ªÜT</strong> v√† 
                          qu√° tr√¨nh ƒëƒÉng k√Ω s·∫Ω b·ªã h·ªßy ngay l·∫≠p t·ª©c.
                        </p>
                        <p className="mt-2 text-sm">
                          Vui l√≤ng li√™n h·ªá v·ªõi nh√¢n vi√™n y t·∫ø ƒë·ªÉ ƒë∆∞·ª£c t∆∞ v·∫•n v√† h·ªó tr·ª£ th√™m.
                        </p>
                      </AlertDescription>
                    </Alert>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {ehrTestResults && Object.entries(ehrTestResults).map(([key, result]) => {
                        const isPositive = result.status === "positive";
                        return (
                          <div
                            key={key}
                            className={`flex items-center justify-between p-4 rounded-lg border-2 ${
                              isPositive
                                ? "bg-red-50 border-red-300"
                                : "bg-gray-50 border-gray-200"
                            }`}
                          >
                            <div>
                              <p className="font-semibold text-gray-900">{testMapping[key]}</p>
                              <p className="text-sm text-gray-500">
                                Ng√†y XN: {new Date(result.date).toLocaleDateString("vi-VN")}
                              </p>
                            </div>
                            <div className={`flex items-center gap-2 ${isPositive ? "text-red-600" : "text-green-600"}`}>
                              {isPositive ? (
                                <>
                                  <span className="text-2xl">‚ö†Ô∏è</span>
                                  <span className="font-bold">D∆∞∆°ng t√≠nh</span>
                                </>
                              ) : (
                                <>
                                  <CheckCircle className="h-5 w-5" />
                                  <span className="font-semibold">√Çm t√≠nh</span>
                                </>
                              )}
                            </div>
                          </div>
                        );
                      })}
                    </div>

                    <div className="bg-red-100 border-2 border-red-300 rounded-lg p-6 text-center">
                      <p className="text-red-800 font-bold text-lg mb-2">
                        H·ªì s∆° kh√¥ng ƒë·ªß ƒëi·ªÅu ki·ªán ti·∫øp t·ª•c
                      </p>
                      <p className="text-red-700 text-sm">
                        Qu√Ω b√† kh√¥ng th·ªÉ ti·∫øp t·ª•c qu√° tr√¨nh ƒëƒÉng k√Ω hi·∫øn s·ªØa m·∫π
                      </p>
                      <Button
                        onClick={() => navigate("/donor")}
                        variant="outline"
                        className="mt-4 border-red-600 text-red-600 hover:bg-red-50"
                      >
                        Quay v·ªÅ Dashboard
                      </Button>
                    </div>
                  </>
                ) : (
                  <>
                    <Alert className="border-green-200 bg-green-50">
                      <CheckCircle className="h-4 w-4 text-green-600" />
                      <AlertDescription className="text-green-800">
                        <strong>‚úì ƒê√£ tr√≠ch xu·∫•t th√†nh c√¥ng!</strong> T·∫•t c·∫£ x√©t nghi·ªám b·ªánh truy·ªÅn nhi·ªÖm ƒë·ªÅu √¢m t√≠nh.
                      </AlertDescription>
                    </Alert>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      {ehrTestResults && Object.entries(ehrTestResults).map(([key, result]) => (
                        <div
                          key={key}
                          className="flex items-center justify-between p-4 bg-gray-50 rounded-lg border"
                        >
                          <div>
                            <p className="font-semibold text-gray-900">{testMapping[key]}</p>
                            <p className="text-sm text-gray-500">
                              Ng√†y XN: {new Date(result.date).toLocaleDateString("vi-VN")}
                            </p>
                          </div>
                          <div className="flex items-center gap-2 text-green-600">
                            <CheckCircle className="h-5 w-5" />
                            <span className="font-semibold">√Çm t√≠nh</span>
                          </div>
                        </div>
                      ))}
                    </div>

                    <Alert className="border-yellow-200 bg-yellow-50">
                      <Info className="h-4 w-4 text-yellow-600" />
                      <AlertDescription className="text-yellow-800">
                        <strong>L∆∞u √Ω:</strong> N·∫øu c√≥ √≠t nh·∫•t 1 k·∫øt qu·∫£ d∆∞∆°ng t√≠nh, h·ªì s∆° s·∫Ω KH√îNG ƒë∆∞·ª£c ph√™ duy·ªát v√† qu√° tr√¨nh ƒëƒÉng k√Ω s·∫Ω b·ªã h·ªßy ngay l·∫≠p t·ª©c.
                      </AlertDescription>
                    </Alert>
                  </>
                )}
              </div>
            )}
          </CardContent>
        </Card>
      </div>
    );
  };

  const renderScheduleForm = () => {
    if (!donorId) return null;

    return (
      <div className="space-y-6">
        {/* Success Message */}
        <Alert className="border-green-200 bg-green-50">
          <CheckCircle className="h-4 w-4 text-green-600" />
          <AlertDescription className="text-green-800">
            <strong>ƒêƒÉng k√Ω th√†nh c√¥ng!</strong> M√£ s·ªë donor:{" "}
            <strong>{donorId}</strong>
          </AlertDescription>
        </Alert>

        {!confirmedAppointment ? (
          <>
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <CalendarIcon className="h-5 w-5 text-pink-500" />
                  ƒê·∫∑t l·ªãch ph·ªèng v·∫•n s√†ng l·ªçc
                </CardTitle>
                <CardDescription>
                  Ch·ªçn ng√†y v√† gi·ªù ph√π h·ª£p ƒë·ªÉ tham gia ph·ªèng v·∫•n s√†ng l·ªçc s·ª©c
                  kh·ªèe
                </CardDescription>
              </CardHeader>
              <CardContent className="space-y-4">
                {/* Time zone info */}
                <div className="flex justify-between items-center text-sm text-gray-500">
                  <div className="flex gap-2">
                    <Button variant="outline" size="sm">
                      Bu·ªïi s√°ng (8AM - 12PM)
                    </Button>
                    <Button variant="outline" size="sm">
                      Bu·ªïi chi·ªÅu (1PM - 5PM)
                    </Button>
                  </div>
                  <span>M√∫i gi·ªù: GMT+7 (TP.HCM)</span>
                </div>

                {/* Calendar Grid */}
                <div className="grid grid-cols-7 gap-3">
                  {Array.from({ length: 7 }).map((_, dayIndex) => {
                    const date = new Date();
                    date.setDate(date.getDate() + dayIndex + 1);
                    const times = ["9:00 AM", "10:30 AM", "2:00 PM", "3:30 PM"];

                    return (
                      <div key={dayIndex} className="space-y-2">
                        <div className="text-center py-2 bg-gray-100 rounded-t-lg">
                          <p className="text-xs text-gray-600">
                            {date.toLocaleDateString("vi-VN", {
                              weekday: "short",
                            })}
                          </p>
                          <p className="text-sm font-medium">
                            {date.toLocaleDateString("vi-VN", {
                              day: "numeric",
                              month: "short",
                            })}
                          </p>
                        </div>
                        <div className="space-y-2">
                          {times.map((time, timeIndex) => {
                            const isSelected =
                              selectedSlot?.date?.getDate() ===
                                date.getDate() && selectedSlot?.time === time;
                            return (
                              <button
                                key={timeIndex}
                                onClick={() => handleSlotSelect(date, time)}
                                className={`w-full p-2 text-xs border rounded transition-colors ${
                                  isSelected
                                    ? "bg-pink-600 text-white border-pink-600"
                                    : "border-gray-300 hover:bg-pink-50 hover:border-pink-600"
                                }`}
                              >
                                {time}
                              </button>
                            );
                          })}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </CardContent>
            </Card>
          </>
        ) : (
          <Card>
            <CardContent className="pt-8 pb-8">
              <div className="text-center space-y-6">
                <CheckCircle className="w-20 h-20 text-green-600 mx-auto" />
                <div>
                  <h2 className="text-2xl font-bold mb-2">
                    ƒê√£ x√°c nh·∫≠n l·ªãch h·∫πn
                  </h2>
                  <p className="text-gray-600">
                    Cu·ªôc ph·ªèng v·∫•n s√†ng l·ªçc c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c s·∫Øp x·∫øp v√†o:
                  </p>
                </div>
                <div className="bg-gray-50 p-6 rounded-lg inline-block">
                  <p className="font-medium text-lg">
                    {selectedSlot?.date.toLocaleDateString("vi-VN", {
                      weekday: "long",
                      year: "numeric",
                      month: "long",
                      day: "numeric",
                    })}
                  </p>
                  <p className="text-gray-600 mt-1">{selectedSlot?.time}</p>
                  <p className="text-sm text-gray-500 mt-3">
                    Qua cu·ªôc g·ªçi video Telehealth
                  </p>
                </div>
                <div className="flex gap-4 justify-center">
                  <Button onClick={() => navigate("/donor")}>
                    <Home className="h-4 w-4 mr-2" />
                    V·ªÅ Dashboard
                  </Button>
                  <Button variant="outline">
                    <CalendarIcon className="h-4 w-4 mr-2" />
                    Th√™m v√†o l·ªãch
                  </Button>
                </div>
              </div>
            </CardContent>
          </Card>
        )}
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50">
      <Header />

      {/* Back to Home Link */}
      <div className="container mx-auto px-4 pt-4">
        <Link
          to="/"
          className="inline-flex items-center text-gray-600 hover:text-gray-800 transition-colors"
        >
          <ArrowLeft className="h-4 w-4 mr-2" />
          V·ªÅ trang ch·ªß
        </Link>
      </div>

      <main className="container mx-auto px-4 py-8">
        <div className="max-w-3xl mx-auto">
          <div className="text-center mb-8">
            <h1 className="text-3xl font-bold text-gray-900 mb-2">
              {userRole === "donor"
                ? "Milk Donation Registration"
                : userRole === "medical_staff"
                ? "Medical Staff Registration"
                : userRole === "director"
                ? "Director Account Registration"
                : "System Registration"}
            </h1>
            <p className="text-gray-600">
              {userRole === "donor"
                ? "Join our community of mothers helping other mothers"
                : userRole === "medical_staff"
                ? "Join our medical team to save lives"
                : userRole === "director"
                ? "Administrative access registration"
                : "Register for system access"}
            </p>
          </div>

          {!registrationComplete ? (
            <>
              <Stepper steps={STEPS} currentStep={currentStep} />

              <div className="mt-8">
                {currentStep === 1 && renderPersonalInfoForm()}
                {currentStep === 2 && renderScreeningForm()}
                {currentStep === 3 && renderReviewForm()}
                {currentStep === 4 && renderScheduleInterviewForm()}
                {currentStep === 5 && renderEHRTestsForm()}
              </div>

              <div className="flex justify-between mt-8">
                <Button
                  variant="outline"
                  onClick={handlePrevious}
                  disabled={currentStep === 1}
                  className="flex items-center gap-2"
                >
                  <ChevronLeft className="h-4 w-4" />
                  Quay l·∫°i
                </Button>

                {currentStep < 5 && !hasPositiveTest && (
                  <Button onClick={handleNext}>
                    {currentStep === 3 ? "X√°c nh·∫≠n & Ti·∫øp t·ª•c" : "Ti·∫øp theo"}
                  </Button>
                )}

                {currentStep === 5 && !hasPositiveTest && (
                  <Button
                    onClick={handleFinalSubmit}
                    disabled={isSubmitting || !ehrTestsExtracted}
                  >
                    {isSubmitting ? "ƒêang g·ª≠i..." : "Ho√†n t·∫•t ƒëƒÉng k√Ω"}
                  </Button>
                )}
              </div>
            </>
          ) : (
            <Card>
              <CardContent className="pt-8 pb-8">
                <div className="text-center space-y-6">
                  <CheckCircle className="w-20 h-20 text-green-600 mx-auto" />
                  <div>
                    <h2 className="text-2xl font-bold mb-2">
                      ƒêƒÉng k√Ω ho√†n t·∫•t! üéâ
                    </h2>
                    <p className="text-gray-600">
                      H·ªì s∆° donor c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng v·ªõi m√£ s·ªë:{" "}
                      <strong className="text-pink-600">{donorId}</strong>
                    </p>
                  </div>
                  <div className="bg-blue-50 p-6 rounded-lg">
                    <p className="text-sm text-gray-700">
                      üìã H·ªì s∆° c·ªßa b·∫°n ƒëang ch·ªù <strong>Gi√°m ƒë·ªëc Ng√¢n h√†ng S·ªØa M·∫π</strong> ph√™ duy·ªát.
                      Sau khi ƒë∆∞·ª£c ph√™ duy·ªát, b·∫°n c√≥ th·ªÉ b·∫Øt ƒë·∫ßu k√Ω cam k·∫øt v√† ƒë·∫∑t l·ªãch hi·∫øn s·ªØa.
                    </p>
                  </div>
                  <div className="flex gap-4 justify-center">
                    <Button onClick={() => navigate("/donor")} size="lg">
                      <Home className="h-5 w-5 mr-2" />
                      V·ªÅ Dashboard
                    </Button>
                    <Button
                      onClick={() => setShowVideoTutorial(true)}
                      variant="outline"
                      size="lg"
                    >
                      üì∫ Xem video h∆∞·ªõng d·∫´n
                    </Button>
                  </div>
                </div>
              </CardContent>
            </Card>
          )}
        </div>
      </main>

      {/* Video Tutorial Modal */}
      {showVideoTutorial && (
        <div className="fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto">
            <div className="p-6">
              <div className="flex justify-between items-center mb-4">
                <h3 className="text-2xl font-bold text-gray-900">
                  Video h∆∞·ªõng d·∫´n hi·∫øn s·ªØa m·∫π
                </h3>
                <button
                  onClick={() => setShowVideoTutorial(false)}
                  className="text-gray-500 hover:text-gray-700"
                >
                  <X className="h-6 w-6" />
                </button>
              </div>

              {/* Video Player Placeholder */}
              <div className="aspect-video bg-gray-900 rounded-lg mb-6 flex items-center justify-center">
                <div className="text-center text-white p-8">
                  <div className="text-6xl mb-4">üé•</div>
                  <h4 className="text-xl font-semibold mb-2">
                    Quy tr√¨nh hi·∫øn s·ªØa m·∫π an to√†n
                  </h4>
                  <p className="text-gray-300 mb-4">
                    Video h∆∞·ªõng d·∫´n chi ti·∫øt s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y
                  </p>
                  <div className="inline-flex items-center gap-2 bg-white/20 px-6 py-3 rounded-full">
                    <span className="text-4xl">‚ñ∂Ô∏è</span>
                    <span>Nh·∫•n ƒë·ªÉ ph√°t video</span>
                  </div>
                </div>
              </div>

              {/* Video Description */}
              <div className="space-y-4">
                <div>
                  <h4 className="font-semibold text-lg mb-2">
                    N·ªôi dung video bao g·ªìm:
                  </h4>
                  <ul className="space-y-2 text-gray-700">
                    <li className="flex items-start gap-2">
                      <CheckCircle className="h-5 w-5 text-green-600 mt-0.5 flex-shrink-0" />
                      <span>Chu·∫©n b·ªã tr∆∞·ªõc khi v·∫Øt s·ªØa (v·ªá sinh, d·ª•ng c·ª•)</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle className="h-5 w-5 text-green-600 mt-0.5 flex-shrink-0" />
                      <span>K·ªπ thu·∫≠t v·∫Øt s·ªØa ƒë√∫ng c√°ch v√† an to√†n</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle className="h-5 w-5 text-green-600 mt-0.5 flex-shrink-0" />
                      <span>B·∫£o qu·∫£n v√† v·∫≠n chuy·ªÉn s·ªØa m·∫π ƒë·∫°t chu·∫©n</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle className="h-5 w-5 text-green-600 mt-0.5 flex-shrink-0" />
                      <span>Quy tr√¨nh ƒë·∫∑t l·ªãch v√† ƒëi·ªÉm hi·∫øn s·ªØa</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle className="h-5 w-5 text-green-600 mt-0.5 flex-shrink-0" />
                      <span>Ch∆∞∆°ng tr√¨nh t√≠ch ƒëi·ªÉm v√† ph·∫ßn th∆∞·ªüng</span>
                    </li>
                  </ul>
                </div>

                <Alert className="border-pink-200 bg-pink-50">
                  <Heart className="h-4 w-4 text-pink-600" />
                  <AlertDescription className="text-pink-800">
                    <strong>C·∫£m ∆°n b·∫°n!</strong> M·ªói gi·ªçt s·ªØa m·∫π c·ªßa b·∫°n ƒë·ªÅu mang l·∫°i s·ª± s·ªëng cho c√°c em b√© c·∫ßn ƒë∆∞·ª£c chƒÉm s√≥c ƒë·∫∑c bi·ªát.
                  </AlertDescription>
                </Alert>

                <div className="flex gap-3">
                  <Button
                    onClick={() => setShowVideoTutorial(false)}
                    className="flex-1"
                  >
                    ƒê√≥ng
                  </Button>
                  <Button
                    onClick={() => navigate("/donor")}
                    variant="outline"
                    className="flex-1"
                  >
                    <Home className="h-4 w-4 mr-2" />
                    V·ªÅ Dashboard
                  </Button>
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      <Toaster />
    </div>
  );
}
